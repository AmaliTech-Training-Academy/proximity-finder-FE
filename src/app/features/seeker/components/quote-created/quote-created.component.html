<app-user-profile-header />
<div class="content">
  <p-tabView>
    <p-tabPanel header="Quotes">
      <div class="tab-content">
        <div class="quotes">
          <h6>Quotes</h6>
          <div class="search">
            <input
              type="text"
              placeholder="Search by project title or name"
              [(ngModel)]="searchTerm"
              (input)="searchQuotes()"
            />
            <img src="../../../../../assets/search.svg" alt="search" />
          </div>

          <div class="all-quotes">
            <div class="quote-container">
              @for(quotes of quotes | reverse; track quotes.quoteId ){

              <div class="quote-list">
                <div class="header">
                  <p>{{ quotes.title }}</p>
                </div>

                <div class="location">
                  <i class="pi pi-map-marker" style="color: #77878f"></i>
                  <p>{{ quotes.location }}</p>
                </div>

                <div class="info">
                  <div class="date">
                    <i class="pi pi-calendar" style="color: #77878f"> Date</i>
                    <p>{{ quotes.startDate }} - {{ quotes.endDate }}</p>
                  </div>

                  <div class="duration">
                    <i class="pi pi-clock" style="color: #77878f"> Duration</i>
                    <p>{{ quotes.duration }}</p>
                  </div>
                  <div class="price">
                    <i class="pi pi-dollar" style="color: #77878f"> Price</i>
                    <p>
                      {{
                        quotes.status === "APPROVED" &&
                        quotes.decision.price !== null &&
                        quotes.decision.price !== undefined
                          ? quotes.decision.price
                          : "Not available"
                      }}
                    </p>
                  </div>
                </div>

                <div
                  class="view-details"
                  (click)="viewQuoteDetails(quotes.quoteId)"
                >
                  <button class="btn-view">View Details</button>
                </div>
              </div>
              }
            </div>

            <div class="details-preview" *ngIf="showDetails && selectedQuote">
              <div class="title">
                <p>{{ selectedQuote.title }}</p>
                <i
                  class="pi pi-times"
                  style="color: #77878f; cursor: pointer"
                  (click)="toggleDetails()"
                ></i>
              </div>

              <div class="received-info">
                <div class="status">
                  <p>Status:</p>
                  <span>{{ selectedQuote.status }}</span>
                </div>

                <div class="due-date">
                  <p>Due Date:</p>
                  <span>{{ selectedQuote.endDate }}</span>
                </div>

                <div class="provider">
                  <p>Provider:</p>
                  <div class="pro">
                    <img src="assets/images/Avatar.png" alt="img" />
                    <span>John Doe</span>
                  </div>
                </div>
              </div>

              <div class="main-content">
                <p-tabView>
                  <p-tabPanel header="Attachments">
                    <div class="tab-content">
                      <div class="photos">
                        @if (selectedQuote.images.length) {
                        <div class="pictures">
                          @for (image of selectedQuote.images; track $index) {
                          <img [src]="image" alt="uploaded image" />
                          }
                        </div>
                        } @else {
                        <p>No images were attached.</p>
                        }
                      </div>
                    </div>
                  </p-tabPanel>
                  <p-tabPanel header="Reply">
                    <div class="tab-content">
                      <div class="reply">
                        <img src="assets/images/Avatar.png" alt="profile-img" />

                        <div class="text">
                          <p>John Does</p>
                          @if(selectedQuote.status === 'APPROVED'){

                          <span
                            [innerHTML]="selectedQuote.decision.approvalDetails"
                          ></span>
                          } @else {
                          <span
                            [innerHTML]="selectedQuote.decision.declineReason"
                          ></span>
                          }
                        </div>
                      </div>
                    </div>
                  </p-tabPanel>
                </p-tabView>
              </div>
            </div>
          </div>
        </div>
      </div>
    </p-tabPanel>
    <p-tabPanel header="Bookings">
      <app-seeker-bookings />
    </p-tabPanel>
  </p-tabView>
</div>
